import{_ as k}from"./BaseIcon-9a927a34.js";import{_ as j}from"./logo-c69ae777.js";import{_ as C}from"./_plugin-vue_export-helper-c27b6911.js";import{o as y,c as V,a as r,b as t,f as B,u as L,g as z,h as M,r as l,i as $,j as h,w as i,l as e,M as T,e as q,E as Y,p as F,m as N,N as G,t as H,O as Q,P as J,n as P,k as R}from"./index-fef6ea2a.js";import{B as U}from"./BaseButton-a302a840.js";const K={},W={class:"bg-white h-[68px] px-10 border-b border-solid border-[#dbdbdb] flex items-center justify-between"},X=r("img",{src:j,alt:""},null,-1),Z={class:"flex items-center"},ee=r("p",{class:"ml-1 text-sm"},"quanna@shop.com",-1);function te(n,a){const c=k;return y(),V("div",W,[X,r("div",Z,[t(c,{icon:"mail",size:"20"}),ee])])}const oe=C(K,[["render",te]]),A=n=>(F("data-v-280aff86"),n=n(),N(),n),se={class:"form-login w-[512px] bg-white m-auto rounded-lg shadow-lg py-[30px] px-6"},ne=A(()=>r("p",{class:"text-[30px] leading-[45px] font-semibold mb-5 text-center"},"Sign In",-1)),ae=A(()=>r("span",{class:"text-base",style:{color:"#201f1e","font-weight":"400","margin-left":"-2px"}}," Remember me ",-1)),re=B({__name:"FormLogin",setup(n){const a=L(),c=z(),v=M(),o=l({username:"",password:""}),d=l({username:[{required:!0,message:"Please enter your username",trigger:"blur"},{type:"email",message:"Please enter a correct username",trigger:"blur"}],password:[{required:!0,message:"Please enter password",trigger:"blur"}]});l("");const b=l(!1),w=l(!1);l(!1);const E=l(!1);$(()=>c.systemParams);const S=$(()=>!(o.value.username&&o.value.password)),u=async()=>{let m="";v.login({...o.value}).then(async()=>{await a.push({name:"Customer",params:{type:"all"}}),m="Logged in successfully",Y.success({message:m,duration:5e3})})};return(m,s)=>{const _=h("el-input"),p=h("el-form-item"),f=k,g=h("el-checkbox"),I=U,O=h("el-form");return y(),V("div",se,[ne,t(O,{ref:"form-login","label-position":"top",class:"form-item",model:e(o),rules:e(d)},{default:i(()=>[t(p,{prop:"username"},{default:i(()=>[t(_,{modelValue:e(o).username,"onUpdate:modelValue":s[0]||(s[0]=x=>e(o).username=x),placeholder:"Email",type:"email"},null,8,["modelValue"])]),_:1}),t(p,{prop:"password",class:"input-password"},{default:i(()=>[t(_,{modelValue:e(o).password,"onUpdate:modelValue":s[2]||(s[2]=x=>e(o).password=x),class:"input-password",type:e(b)==!0?"text":"password",placeholder:"Password"},{append:i(()=>[r("div",{class:"icon-eye cursor-pointer",onClick:s[1]||(s[1]=x=>b.value=!e(b))},[t(f,{icon:e(b)==!0?"eye-off":"eye",size:"22"},null,8,["icon"])])]),_:1},8,["modelValue","type"])]),_:1}),t(g,{modelValue:e(w),"onUpdate:modelValue":s[3]||(s[3]=x=>T(w)?w.value=x:null)},{default:i(()=>[ae]),_:1},8,["modelValue"]),t(I,{class:"my-6",loading:e(E),disabled:e(S),onClick:u},{default:i(()=>[q(" Sign In ")]),_:1},8,["loading","disabled"])]),_:1},8,["model","rules"])])}}});const le=C(re,[["__scopeId","data-v-280aff86"]]),D=n=>(F("data-v-71ed6392"),n=n(),N(),n),ie={class:"form-verify w-[512px] bg-white m-auto rounded-lg shadow-lg py-[30px] px-6"},ce={class:"text-[30px] leading-[45px] font-semibold text-center color-[#201f1e]"},de={class:"flex items-center"},ue={key:0,class:"mt-6 flex justify-center text-base text-[#605e5c]"},me=D(()=>r("p",null,"Didn’t receive any verification code?  ",-1)),pe=D(()=>r("p",{class:"text-hyperlink font-semibold cursor-pointer"},"Resend code",-1)),_e=[me,pe],fe=B({__name:"FormVerify",setup(n){const a=G(),c=L(),v=M(),o=l({code:""}),d=l(!1),b=l({code:[{required:!0,message:"Please enter verification code",trigger:"blur"}]}),w=$(()=>{switch(a.params.type){case"email":return"Enter the 6-digit code we texted to your email";case"app":return"Enter the 6-digit code from your authenticator app";default:return"Enter the 6-digit code we texted to your phone number"}}),E=$(()=>`verify-${a.params.type}`),S=async()=>{try{d.value=!0;let u="";const m=a.query.pass,s=a.query.email,_=a.query.reason,p={email:s,password:m,verificationCode:o.value.code};_==="REQUEST_LOGIN"&&v.login({...p}).then(async()=>{const g=(await P.getInfo()).roles;g.length==1&&g.includes("INVESTOR")||g.length==0?(u="You don’t have permission to access",ElMessage.error({message:u,duration:5e3}),await v.logout(),c.push({name:"login"})):(u="Verification successful",ElMessage.error({message:u,duration:5e3}),c.push({name:"Customer",params:{type:"all"}})),d.value=!1}).catch(()=>{d.value=!1}),_==="VERIFY-SMS"&&(delete p.password,P.verifyCode("CODE",{...p,type:"SMS"}).then(f=>{v.setUserInfo(f),c.push({name:"Customer",params:{type:"all"}})}).catch(f=>{d.value=!1}))}catch{d.value=!1}};return(u,m)=>{const s=k,_=h("el-input"),p=h("el-form-item"),f=h("el-form"),g=U;return y(),V("div",ie,[r("p",ce,H(e(w)),1),r("div",de,[t(s,{icon:e(E),size:"80"},null,8,["icon"]),t(f,{ref:"form-verify","label-position":"top",model:e(o),rules:e(b),class:"w-full mt-[17px] ml-[10px]",onSubmit:Q(S,["prevent"])},{default:i(()=>[t(p,{prop:"code",label:"Enter 2-step authentication code:",class:"form-item-code"},{default:i(()=>[t(_,{modelValue:e(o).code,"onUpdate:modelValue":m[0]||(m[0]=I=>e(o).code=I),modelModifiers:{trim:!0},type:"text",maxlength:"6",placeholder:"Verification code"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules","onSubmit"])]),t(g,{loading:e(d),disabled:e(o).code.length!==6,onClick:S},{default:i(()=>[q("Submit")]),_:1},8,["loading","disabled"]),e(a).params.type!=="app"?(y(),V("div",ue,_e)):J("",!0)])}}});const ge=C(fe,[["__scopeId","data-v-71ed6392"]]),he={class:"h-screen bg-[#f6f8fc]"},ye={class:"content pt-10"},Se=B({__name:"AuthView",setup(n){return(a,c)=>(y(),V("div",he,[t(oe),r("div",ye,[a.$route.name==="LoginPage"?(y(),R(le,{key:0})):(y(),R(ge,{key:1}))])]))}});export{Se as default};
